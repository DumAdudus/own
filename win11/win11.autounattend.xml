<?xml version="1.0" encoding="utf-8"?>
<unattend xmlns="urn:schemas-microsoft-com:unattend"
    xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State">
    <!--IoT-LTSC-Like x64 Unattended Windows Installation File to Automatically Debloat Windows 10 & 11 During Installation-->
    <!--Compiled by Memory's Tech Tips https://www.youtube.com/@memstechtips | https://memstechtips.blogspot.com/ -->
    <!--Credit to Schneegans.de as the Base File was Generated with https://schneegans.de/windows/unattend-generator/ -->
    <!--Credit to Chris Titus Tech as this file contains Tweaks from The Windows Utility https://github.com/ChrisTitusTech/winutil | https://christitus.com/windows-tool/ | https://www.youtube.com/@ChrisTitusTech/ -->
    <settings pass="offlineServicing"></settings>
    <settings pass="windowsPE">
        <component name="Microsoft-Windows-International-Core-WinPE" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
            <SetupUILanguage>
                <UILanguage>en-US</UILanguage>
            </SetupUILanguage>
            <InputLocale>0409:00000409</InputLocale>
            <SystemLocale>en-US</SystemLocale>
            <UILanguage>en-US</UILanguage>
            <UserLocale>en-US</UserLocale>
        </component>
        <component name="Microsoft-Windows-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
            <DiskConfiguration>
                <DisableEncryptedDiskProvisioning>true</DisableEncryptedDiskProvisioning>
                <WillShowUI>OnError</WillShowUI>

                <Disk wcm:action="add">
                    <DiskID>0</DiskID>
                    <WillWipeDisk>true</WillWipeDisk>
                    <CreatePartitions>
                        <!-- EFI system partition (ESP) -->
                        <CreatePartition wcm:action="add">
                            <Order>1</Order>
                            <Type>EFI</Type>
                            <Size>100</Size>
                        </CreatePartition>

                        <!-- Microsoft reserved partition (MSR) -->
                        <CreatePartition wcm:action="add">
                            <Order>2</Order>
                            <Type>MSR</Type>
                            <Size>16</Size>
                        </CreatePartition>

                        <!-- Windows partition -->
                        <CreatePartition wcm:action="add">
                            <Order>3</Order>
                            <Type>Primary</Type>
                            <Extend>true</Extend>
                        </CreatePartition>
                    </CreatePartitions>
                    <ModifyPartitions>
                        <!-- EFI system partition (ESP) -->
                        <ModifyPartition wcm:action="add">
                            <Order>1</Order>
                            <PartitionID>1</PartitionID>
                            <Label>System</Label>
                            <Format>FAT32</Format>
                        </ModifyPartition>

                        <!-- MSR partition does not need to be modified -->

                        <!-- Windows partition -->
                        <ModifyPartition wcm:action="add">
                            <Order>2</Order>
                            <PartitionID>3</PartitionID>
                            <Label>Windows</Label>
                            <Letter>C</Letter>
                            <Format>NTFS</Format>
                        </ModifyPartition>
                    </ModifyPartitions>
                </Disk>
            </DiskConfiguration>
            <ImageInstall>
                <OSImage>
                    <WillShowUI>OnError</WillShowUI>
                    <InstallFrom>
                        <MetaData wcm:action="add">
                            <Key>/IMAGE/NAME</Key>
                            <Value>Windows 11 IoT Enterprise LTSC</Value>
                        </MetaData>
                    </InstallFrom>
                    <InstallTo>
                        <DiskID>0</DiskID>
                        <PartitionID>3</PartitionID>
                    </InstallTo>
                </OSImage>
            </ImageInstall>
            <UserData>
                <ProductKey>
                    <Key />
                    <WillShowUI>Never</WillShowUI>
                </ProductKey>
                <AcceptEula>true</AcceptEula>
                <Organization>BDSEC</Organization>
            </UserData>
            <RunSynchronous>
                <RunSynchronousCommand wcm:action="add">
                    <Order>1</Order>
                    <Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassTPMCheck /t REG_DWORD /d 1 /f</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>2</Order>
                    <Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassSecureBootCheck /t REG_DWORD /d 1 /f</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>3</Order>
                    <Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassStorageCheck /t REG_DWORD /d 1 /f</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>4</Order>
                    <Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassCPUCheck /t REG_DWORD /d 1 /f</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>5</Order>
                    <Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassRAMCheck /t REG_DWORD /d 1 /f</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>6</Order>
                    <Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassDiskCheck /t REG_DWORD /d 1 /f</Path>
                </RunSynchronousCommand>
            </RunSynchronous>
        </component>
    </settings>
    <settings pass="generalize"></settings>
    <settings pass="specialize">
        <component name="Microsoft-Windows-Deployment" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
            <RunSynchronous>
                <RunSynchronousCommand wcm:action="add">
                    <Order>1</Order>
                    <Description>Extracts and Executes Scripts in this XML File</Description>
                    <Path>powershell.exe -NoProfile -WindowStyle Hidden -Command "$xml = [xml]::new(); $xml.Load('C:\Windows\Panther\unattend.xml'); $sb = [scriptblock]::Create( $xml.unattend.Extensions.ExtractScript ); Invoke-Command -ScriptBlock $sb -ArgumentList $xml;"</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>2</Order>
                    <Description>Executes the remove-packages Powershell Script</Description>
                    <Path>powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\remove-packages.ps1' -Raw | Invoke-Expression;"</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>3</Order>
                    <Description>Run Chris Titus WinUtil Tweaks</Description>
                    <Path>powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\wintweaks.ps1' -Raw | Invoke-Expression;"</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>4</Order>
                    <Description>Executes the HKLM Registry Entries Script</Description>
                    <Path>cmd.exe /c "C:\Windows\Setup\Scripts\localmachine.cmd &gt;&gt;"C:\Windows\Setup\Scripts\localmachine.log" 2&gt;&amp;1"</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>5</Order>
                    <Description>Adds Items to Right-Click Context Menu</Description>
                    <Path>cmd.exe /c "reg.exe import "C:\Windows\Setup\Scripts\contextmenu.reg" &gt;&gt;"C:\Windows\Setup\Scripts\contextmenu.log" 2&gt;&amp;1"</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>6</Order>
                    <Description>Loads the Default User Registry Hive so Changes Can be Made to It</Description>
                    <Path>reg.exe load "HKU\DefaultUser" "C:\Users\Default\NTUSER.DAT"</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>7</Order>
                    <Path>reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Runonce" /v "GeoLocation" /t REG_SZ /d "powershell.exe -NoProfile -Command \"Set-WinHomeLocation -GeoId 45;\"" /f</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>8</Order>
                    <Description>Registry Entry to Execute the HKU\DefaultUser Registry Entries Script</Description>
                    <Path>cmd.exe /c "C:\Windows\Setup\Scripts\defaultuser.cmd &gt;&gt;"C:\Windows\Setup\Scripts\defaultuser.log" 2&gt;&amp;1"</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>9</Order>
                    <Description>Registry Entry to Execute the HKCU Registry Entry Script the First Time a New User Logs In</Description>
                    <Path>reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Runonce" /v "currentuser" /t REG_SZ /d "powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -File C:\Windows\Setup\Scripts\currentuser.ps1" /f</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>10</Order>
                    <Description>Unloads the Default User Registry Hive</Description>
                    <Path>reg.exe unload "HKU\DefaultUser"</Path>
                </RunSynchronousCommand>
                <RunSynchronousCommand wcm:action="add">
                    <Order>11</Order>
                    <Description>Enable OpenSSH Server</Description>
                    <Path>powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\openssh.ps1' -Raw | Invoke-Expression;"</Path>
                </RunSynchronousCommand>
            </RunSynchronous>
        </component>
        <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
            <TimeZone>China Standard Time</TimeZone>
        </component>
        <component name="Microsoft-Windows-SystemRestore-Main" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
            <DisableSR>1</DisableSR>
        </component>
        <component name="Microsoft-Windows-ErrorReportingCore" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
            <DisableWER>1</DisableWER>
        </component>
        <component name="Microsoft-Windows-SQMApi" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="NonSxS">
            <CEIPEnabled>0</CEIPEnabled>
        </component>
    </settings>
    <settings pass="auditSystem"></settings>
    <settings pass="auditUser"></settings>
    <settings pass="oobeSystem">
        <component name="Microsoft-Windows-International-Core" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
            <InputLocale>0409:00000409</InputLocale>
            <SystemLocale>zh-CN</SystemLocale>
            <UILanguage>zh-CN</UILanguage>
            <UILanguageFallback>en-US</UILanguageFallback>
            <UserLocale>zh-CN</UserLocale>
        </component>
        <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
            <OOBE>
                <HideEULAPage>true</HideEULAPage>
                <HideOEMRegistrationScreen>true</HideOEMRegistrationScreen>
                <HideOnlineAccountScreens>true</HideOnlineAccountScreens>
                <HideWirelessSetupInOOBE>true</HideWirelessSetupInOOBE>
                <NetworkLocation>Work</NetworkLocation>
                <ProtectYourPC>3</ProtectYourPC>
            </OOBE>
            <UserAccounts>
                <LocalAccounts>
                    <LocalAccount wcm:action="add">
                        <Name>sec</Name>
                        <Group>Administrators</Group>
                        <Password>
                            <Value>MQBQAGEAcwBzAHcAbwByAGQA</Value>
                            <PlainText>false</PlainText>
                        </Password>
                    </LocalAccount>
                </LocalAccounts>
            </UserAccounts>
            <AutoLogon>
                <Username>sec</Username>
                <Enabled>true</Enabled>
                <LogonCount>1</LogonCount>
                <Password>
                    <Value>MQBQAGEAcwBzAHcAbwByAGQA</Value>
                    <PlainText>false</PlainText>
                </Password>
            </AutoLogon>
            <FirstLogonCommands>
                <SynchronousCommand wcm:action="add">
                    <Order>1</Order>
                    <CommandLine>reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v AutoLogonCount /t REG_DWORD /d 0 /f</CommandLine>
                </SynchronousCommand>
                <!-- <SynchronousCommand wcm:action="add">
                    <Order>2</Order>
                    <CommandLine>powershell.exe -NoProfile -Command "Disable-ComputerRestore -Drive 'C:\';"</CommandLine>
                </SynchronousCommand> -->
                <SynchronousCommand wcm:action="add">
                    <Order>4</Order>
                    <CommandLine>powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\cloudinit.ps1' -Raw | Invoke-Expression;"</CommandLine>
                </SynchronousCommand>
                <SynchronousCommand wcm:action="add">
                    <Order>5</Order>
                    <CommandLine>cmd.exe /c "C:\Windows\Setup\Scripts\currentuser.cmd &gt;&gt;"C:\Windows\Setup\Scripts\currentuser.log" 2&gt;&amp;1"</CommandLine>
                </SynchronousCommand>
                <SynchronousCommand wcm:action="add">
                    <Order>6</Order>
                    <CommandLine>powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\Warez.ps1' -Raw | Invoke-Expression;"</CommandLine>
                </SynchronousCommand>
            </FirstLogonCommands>
        </component>
    </settings>
    <Extensions>
        <ExtractScript>
param(
    [xml] $Document
);

$scriptsDir = 'C:\Windows\Setup\Scripts\';
foreach( $file in $Document.unattend.Extensions.File ) {
    $path = [System.Environment]::ExpandEnvironmentVariables(
        $file.GetAttribute( 'path' )
    );
    if( $path.StartsWith( $scriptsDir ) ) {
        mkdir -Path $scriptsDir -ErrorAction 'SilentlyContinue';
    }
    $encoding = switch( [System.IO.Path]::GetExtension( $path ) ) {
        { $_ -in '.ps1', '.xml' } { [System.Text.Encoding]::UTF8; }
        { $_ -in '.reg', '.vbs', '.js' } { [System.Text.UnicodeEncoding]::new( $false, $true ); }
        default { [System.Text.Encoding]::Default; }
    };
    [System.IO.File]::WriteAllBytes( $path, ( $encoding.GetPreamble() + $encoding.GetBytes( $file.InnerText.Trim() ) ) );
}
        </ExtractScript>

        <!--Removes Preinstalled Bloatware Apps-->
        <File path="C:\Windows\Setup\Scripts\remove-packages.ps1"><![CDATA[
  Get-AppxProvisionedPackage -Online |
  Where-Object -Property 'DisplayName' -In -Value @(
  'Microsoft.Microsoft3DViewer';
  'Microsoft.BingSearch';
  'Microsoft.WindowsCamera';
  'Clipchamp.Clipchamp';
  'Microsoft.WindowsAlarms';
  'Microsoft.549981C3F5F10';
  'Microsoft.Windows.DevHome';
  'MicrosoftCorporationII.MicrosoftFamily';
  'Microsoft.WindowsFeedbackHub';
  'Microsoft.GetHelp';
  'microsoft.windowscommunicationsapps';
  'Microsoft.WindowsMaps';
  'Microsoft.ZuneVideo';
  'Microsoft.BingNews';
  'Microsoft.MicrosoftOfficeHub';
  'Microsoft.Office.OneNote';
  'Microsoft.OutlookForWindows';
  'Microsoft.MSPaint';
  'Microsoft.People';
  'Microsoft.Windows.Photos';
  'Microsoft.PowerAutomateDesktop';
  'MicrosoftCorporationII.QuickAssist';
  'Microsoft.SkypeApp';
  'Microsoft.ScreenSketch';
  'Microsoft.MicrosoftSolitaireCollection';
  'Microsoft.MicrosoftStickyNotes';
  'MSTeams';
  'Microsoft.Getstarted';
  'Microsoft.Todos';
  'Microsoft.WindowsSoundRecorder';
  'Microsoft.BingWeather';
  'Microsoft.ZuneMusic';
  'Microsoft.WindowsTerminal';
  'Microsoft.Xbox.TCUI';
  'Microsoft.XboxApp';
  'Microsoft.XboxGameOverlay';
  'Microsoft.XboxGamingOverlay';
  'Microsoft.XboxIdentityProvider';
  'Microsoft.XboxSpeechToTextOverlay';
  'Microsoft.GamingApp';
  'Microsoft.YourPhone';
  'Microsoft.OneDrive';
  'Microsoft.549981C3F5F10';
  'Microsoft.MixedReality.Portal';
  'Microsoft.Windows.Ai.Copilot.Provider';
  'Microsoft.WindowsMeetNow';
) | Remove-AppxProvisionedPackage -AllUsers -Online

Get-WindowsCapability -Online |
Where-Object -FilterScript {
  ($_.Name -split '~')[0] -in @(
    'Browser.InternetExplorer';
    'MathRecognizer';
    'OpenSSH.Client';
    'Microsoft.Windows.PowerShell.ISE';
    'App.Support.QuickAssist';
    'App.StepsRecorder';
    'Microsoft.Windows.WordPad';
  );
} | Remove-WindowsCapability -Online]]>
        </File>

        <!--Powershell Script to Run Various Tweaks, Most of These are from the Chris Titus Tech Windows Utility (Credit:https://christitus.com/windows-tool/)-->
        <File path="C:\Windows\Setup\Scripts\wintweaks.ps1"><![CDATA[
            $logFile = "C:\Windows\Setup\Scripts\wintweaks.log"
            Start-Transcript -Path $logFile

            # Enables .NET Framework 3.5
            DISM /Online /Enable-Feature /FeatureName:NetFx3 /All /Source:X:\sources\sxs /LimitAccess

            # Configure Maximum Password Age in Windows
            net.exe accounts /maxpwage:UNLIMITED

            # Enabld RDP
            netsh.exe advfirewall firewall set rule group="Remote Desktop" new enable=Yes

            # Allow Execution of PowerShell Script Files
            Set-ExecutionPolicy -Scope 'LocalMachine' -ExecutionPolicy 'RemoteSigned' -Force

            # Groups or splits svchost.exe processes based on the amount of physical memory in the system to optimize performance
            $ram = (Get-CimInstance -ClassName Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum).Sum / 1kb
            Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control" -Name "SvcHostSplitThresholdInKB" -Type DWord -Value $ram -Force

            $autoLoggerDir = "$env:PROGRAMDATA\Microsoft\Diagnosis\ETLLogs\AutoLogger"
            If (Test-Path "$autoLoggerDir\AutoLogger-Diagtrack-Listener.etl") {
                Remove-Item "$autoLoggerDir\AutoLogger-Diagtrack-Listener.etl"
            }
            $icaclsCommand = "icacls `"$autoLoggerDir`" /deny SYSTEM:`"(OI)(CI)F`""
            Invoke-Expression $icaclsCommand | Out-Null

            # Disable Defender Auto Sample Submission
            Set-MpPreference -SubmitSamplesConsent 2 -ErrorAction Continue | Out-Null

            # Removes OneDrive
            Remove-Item "C:\Users\Default\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk" -ErrorAction Continue
            Remove-Item "C:\Users\Default\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.exe" -ErrorAction Continue
            Remove-Item "C:\Windows\System32\OneDriveSetup.exe" -ErrorAction Continue
            Remove-Item "C:\Windows\SysWOW64\OneDriveSetup.exe" -ErrorAction Continue

            # Removes Microsoft Teams
            $TeamsPath = [System.IO.Path]::Combine($env:LOCALAPPDATA, 'Microsoft', 'Teams')
            $TeamsUpdateExePath = [System.IO.Path]::Combine($TeamsPath, 'Update.exe')

            Stop-Process -Name "*teams*" -Force -ErrorAction Continue

            if ([System.IO.File]::Exists($TeamsUpdateExePath)) {
                # Uninstall app
                $proc = Start-Process $TeamsUpdateExePath "-uninstall -s" -PassThru
                $proc.WaitForExit()
            }

            Get-AppxPackage "*Teams*" | Remove-AppxPackage -ErrorAction Continue
            Get-AppxPackage "*Teams*" -AllUsers | Remove-AppxPackage -AllUsers -ErrorAction Continue

            if ([System.IO.Directory]::Exists($TeamsPath)) {
                Remove-Item $TeamsPath -Force -Recurse -ErrorAction Continue
            }

            # Uninstall from Uninstall registry key UninstallString
            $us = (Get-ChildItem -Path HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall, HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall | Get-ItemProperty | Where-Object { $_.DisplayName -like '*Teams*'}).UninstallString
            if ($us.Length -gt 0) {
                $us = ($us.Replace('/I', '/uninstall ') + ' /quiet').Replace('  ', ' ')
                $FilePath = ($us.Substring(0, $us.IndexOf('.exe') + 4).Trim())
                $ProcessArgs = ($us.Substring($us.IndexOf('.exe') + 5).Trim().replace('  ', ' '))
                $proc = Start-Process -FilePath $FilePath -Args $ProcessArgs -PassThru
                $proc.WaitForExit()
            }

            # Disables Teredo
            $registryKeysTeredo = @(
                @{Path = "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters"; Name = "DisabledComponents"; Type = "DWord"; Value = 1}
            )
            foreach ($key in $registryKeysTeredo) {
                New-ItemProperty -Path $key.Path -Name $key.Name -PropertyType $key.Type -Value $key.Value -Force
            }
            netsh interface teredo set state disabled

            # Disables Telemetry
            # Disable Scheduled Tasks
            $scheduledTasks = @(
                "Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser",
                "Microsoft\Windows\Application Experience\ProgramDataUpdater",
                "Microsoft\Windows\Autochk\Proxy",
                "Microsoft\Windows\Customer Experience Improvement Program\Consolidator",
                "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip",
                "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector",
                "Microsoft\Windows\Feedback\Siuf\DmClient",
                "Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload",
                "Microsoft\Windows\Windows Error Reporting\QueueReporting",
                "Microsoft\Windows\Application Experience\MareBackup",
                "Microsoft\Windows\Application Experience\StartupAppTask",
                "Microsoft\Windows\Application Experience\PcaPatchDbTask",
                "Microsoft\Windows\Maps\MapsUpdateTask"
            )
            foreach ($task in $scheduledTasks) {
                schtasks /Change /TN $task /Disable
            }

            # Enable the Ultimate Performance power plan
            powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61

            # Set the Ultimate Performance power plan as active
            powercfg -setactive e9a42b02-d5df-448d-aa00-03f14749eb61

            # Set Services to Manual
            Write-Output 'Set Services to Manual: Turns a bunch of system services to manual that do not need to be running all the time.'
            Set-Service -Name 'AJRouter' -StartupType Disabled -ErrorAction Continue
            Set-Service -Name 'ALG' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'AppIDSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'AppMgmt' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'AppReadiness' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'AppVClient' -StartupType Disabled -ErrorAction Continue
            Set-Service -Name 'AppXSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'Appinfo' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'AssignedAccessManagerSvc' -StartupType Disabled -ErrorAction Continue
            Set-Service -Name 'AudioEndpointBuilder' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'AudioSrv' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'Audiosrv' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'AxInstSV' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'BDESVC' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'BFE' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'BITS' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'BTAGService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'BcastDVRUserService_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'BrokerInfrastructure' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'Browser' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'BthAvctpSvc' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'BthHFSrv' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'CDPSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'CDPUserSvc_*' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'COMSysApp' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'CaptureService_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'CertPropSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'ClipSVC' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'ConsentUxUserSvc_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'CoreMessagingRegistrar' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'CredentialEnrollmentManagerUserSvc_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'CryptSvc' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'CscService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'DPS' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'DcomLaunch' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'DcpSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'DevQueryBroker' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'DeviceAssociationBrokerSvc_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'DeviceAssociationService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'DeviceInstall' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'DevicePickerUserSvc_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'DevicesFlowUserSvc_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'Dhcp' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'DiagTrack' -StartupType Disabled -ErrorAction Continue
            Set-Service -Name 'DialogBlockingService' -StartupType Disabled -ErrorAction Continue
            Set-Service -Name 'DispBrokerDesktopSvc' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'DisplayEnhancementService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'DmEnrollmentSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'Dnscache' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'DoSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'DsSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'DsmSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'DusmSvc' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'EFS' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'EapHost' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'EntAppSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'EventLog' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'EventSystem' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'FDResPub' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'Fax' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'FontCache' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'FrameServer' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'FrameServerMonitor' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'GraphicsPerfSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'HomeGroupListener' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'HomeGroupProvider' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'HvHost' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'IEEtwCollectorService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'IKEEXT' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'InstallService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'InventorySvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'IpxlatCfgSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'KeyIso' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'KtmRm' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'LSM' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'LanmanServer' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'LanmanWorkstation' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'LicenseManager' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'LxpSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'MSDTC' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'MSiSCSI' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'MapsBroker' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'McpManagementService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'MessagingService_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'MicrosoftEdgeElevationService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'MixedRealityOpenXRSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'MpsSvc' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'MsKeyboardFilter' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'NPSMSvc_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'NaturalAuthentication' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'NcaSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'NcbService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'NcdAutoSetup' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'NetSetupSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'NetTcpPortSharing' -StartupType Disabled -ErrorAction Continue
            Set-Service -Name 'Netlogon' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'Netman' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'NgcCtnrSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'NgcSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'NlaSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'OneSyncSvc_*' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'P9RdrService_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'PNRPAutoReg' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'PNRPsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'PcaSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'PeerDistSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'PenService_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'PerfHost' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'PhoneSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'PimIndexMaintenanceSvc_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'PlugPlay' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'PolicyAgent' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'Power' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'PrintNotify' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'PrintWorkflowUserSvc_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'ProfSvc' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'PushToInstall' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'QWAVE' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'RasAuto' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'RasMan' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'RemoteAccess' -StartupType Disabled -ErrorAction Continue
            Set-Service -Name 'RemoteRegistry' -StartupType Disabled -ErrorAction Continue
            Set-Service -Name 'RetailDemo' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'RmSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'RpcEptMapper' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'RpcLocator' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'RpcSs' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'SCPolicySvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SCardSvr' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SDRSVC' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SEMgrSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SENS' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'SNMPTRAP' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SNMPTrap' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SSDPSRV' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SamSs' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'ScDeviceEnum' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'Schedule' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'SecurityHealthService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'Sense' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SensorDataService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SensorService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SensrSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SessionEnv' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SgrmBroker' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'SharedAccess' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SharedRealitySvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'ShellHWDetection' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'SmsRouter' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'Spooler' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'SstpSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'StateRepository' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'StiSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'StorSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'SysMain' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'SystemEventsBroker' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'TabletInputService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'TapiSrv' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'TermService' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'TextInputManagementService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'Themes' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'TieringEngineService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'TimeBroker' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'TimeBrokerSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'TokenBroker' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'TrkWks' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'TroubleshootingSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'TrustedInstaller' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'UI0Detect' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'UdkUserSvc_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'UevAgentService' -StartupType Disabled -ErrorAction Continue
            Set-Service -Name 'UmRdpService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'UnistoreSvc_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'UserDataSvc_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'UserManager' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'UsoSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'VGAuthService' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'VMTools' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'VSS' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'VacSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'VaultSvc' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'W32Time' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WEPHOSTSVC' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WFDSConMgrSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WMPNetworkSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WManSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WPDBusEnum' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WSService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WSearch' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WaaSMedicSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WalletService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WarpJITSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WbioSrvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'Wcmsvc' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'WcsPlugInService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WdNisSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WdiServiceHost' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WdiSystemHost' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WebClient' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'Wecsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WerSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WiaRpc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WinDefend' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'WinHttpAutoProxySvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WinRM' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'Winmgmt' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'WlanSvc' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'WpcMonSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WpnService' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'WpnUserService_*' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'WwanSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'XblAuthManager' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'XblGameSave' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'XboxGipSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'XboxNetApiSvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'autotimesvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'bthserv' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'camsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'cbdhsvc_*' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'cloudidsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'dcsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'defragsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'diagnosticshub.standardcollector.service' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'diagsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'dmwappushservice' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'dot3svc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'edgeupdate' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'edgeupdatem' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'embeddedmode' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'fdPHost' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'fhsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'gpsvc' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'hidserv' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'icssvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'iphlpsvc' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'lfsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'lltdsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'lmhosts' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'mpssvc' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'msiserver' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'netprofm' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'nsi' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'p2pimsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'p2psvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'perceptionsimulation' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'pla' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'seclogon' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'shpamsvc' -StartupType Disabled -ErrorAction Continue
            Set-Service -Name 'smphost' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'spectrum' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'sppsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'ssh-agent' -StartupType Disabled -ErrorAction Continue
            Set-Service -Name 'svsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'swprv' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'tiledatamodelsvc' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'tzautoupdate' -StartupType Disabled -ErrorAction Continue
            Set-Service -Name 'uhssvc' -StartupType Disabled -ErrorAction Continue
            Set-Service -Name 'upnphost' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'vds' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'vm3dservice' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'vmicguestinterface' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'vmicheartbeat' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'vmickvpexchange' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'vmicrdv' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'vmicshutdown' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'vmictimesync' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'vmicvmsession' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'vmicvss' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'vmvss' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'wbengine' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'wcncsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'webthreatdefsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'webthreatdefusersvc_*' -StartupType Automatic -ErrorAction Continue
            Set-Service -Name 'wercplsupport' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'wisvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'wlidsvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'wlpasvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'wmiApSrv' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'workfolderssvc' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'wuauserv' -StartupType Manual -ErrorAction Continue
            Set-Service -Name 'wudfsvc' -StartupType Manual -ErrorAction Continue

            Stop-Transcript]]>
        </File>

        <!--Local Machine Registry Entries - This Sets Features for the Local Machine-->
        <File path="C:\Windows\Setup\Scripts\localmachine.cmd"><![CDATA[
            :: Bypasses Microsoft Account Creation
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OOBE" /v BypassNRO /t REG_DWORD /d 1 /f

            :: Disables User Account Control - Without this entry, the currentuser.cmd file won't automatically run as Admin and some of the commands will fail. If you use UAC, just enable it in Control Panel.
            :: reg.exe add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v EnableLUA /t REG_DWORD /d 0 /f

            :: Disable Windows Spotlight and set the normal Windows Picture as the desktop background
            :: Disable Windows Spotlight on the lock screen
            reg.exe add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsSpotlightOnLockScreen /t REG_DWORD /d 1 /f
            :: Disable Windows Spotlight suggestions, tips, tricks, and more on the lock screen
            reg.exe add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsConsumerFeatures /t REG_DWORD /d 1 /f
            :: Disable Windows Spotlight on Settings
            reg.exe add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsSpotlightActiveUser /t REG_DWORD /d 1 /f
            :: Set desktop background to a normal Windows picture
            reg.exe add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v Wallpaper /t REG_SZ /d "C:\Windows\Web\Wallpaper\Windows\img19.jpg" /f
            :: Ensure the wallpaper style is set to fill (2 is for fill, 10 is for fit)
            reg.exe add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v WallpaperStyle /t REG_SZ /d "2" /f

            :: Prevents Dev Home Installation
            reg.exe delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\DevHomeUpdate" /f

            :: Prevents New Outlook for Windows Installation
            reg.exe delete "HKLM\SOFTWARE\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate" /f

            :: Prevents Chat Auto Installation and Removes Chat Icon
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Communications" /v ConfigureChatAutoInstall /t REG_DWORD /d 0 /f
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Chat" /v "ChatIcon" /t REG_DWORD /d 3 /f

            :: Start Menu Customization
            :: reg.exe add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Start" /v ConfigureStartPins /t REG_SZ /d "{ \"pinnedList\": [] }" /f
            reg.exe add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Start" /v ConfigureStartPins_ProviderSet /t REG_DWORD /d 1 /f
            reg.exe add "HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Start" /v ConfigureStartPins_WinningProvider /t REG_SZ /d B5292708-1619-419B-9923-E5D9F3925E71 /f
            :: reg.exe add "HKLM\SOFTWARE\Microsoft\PolicyManager\providers\B5292708-1619-419B-9923-E5D9F3925E71\default\Device\Start" /v ConfigureStartPins /t REG_SZ /d "{ \"pinnedList\": [] }" /f
            reg.exe add "HKLM\SOFTWARE\Microsoft\PolicyManager\providers\B5292708-1619-419B-9923-E5D9F3925E71\default\Device\Start" /v ConfigureStartPins_LastWrite /t REG_DWORD /d 1 /f

            :: Enable Long File Paths with Up to 32,767 Characters
            reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v LongPathsEnabled /t REG_DWORD /d 1 /f

            :: Disables News and Interests
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Dsh" /v AllowNewsAndInterests /t REG_DWORD /d 0 /f

            :: Enable RDP
            reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f

            :: Disables Windows Consumer Features Like App Promotions etc.
            reg.exe add "HKLM\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsConsumerFeatures" /t REG_DWORD /d 0 /f

            :: Disables Bitlocker Auto Encryption on Windows 11 24H2 and Onwards
            reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\BitLocker" /v "PreventDeviceEncryption" /t REG_DWORD /d 1 /f
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\EnhancedStorageDevices" /v TCGSecurityActivationDisabled /t REG_DWORD /d 1 /f

            :: Sets Windows Update to Only Install Security Updates and Delay Other Updates for 2 Years
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v AUOptions /t REG_DWORD /d 3 /f
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v DeferFeatureUpdates /t REG_DWORD /d 1 /f
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v DeferFeatureUpdatesPeriodInDays /t REG_DWORD /d 365 /f
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v DeferQualityUpdates /t REG_DWORD /d 1 /f
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" /v DeferQualityUpdatesPeriodInDays /t REG_DWORD /d 365 /f

            :: Disables Cortana
            reg.exe add "HKLM\Software\Policies\Microsoft\Windows\Windows Search" /v AllowCortana /t REG_DWORD /d 0 /f

            :: Disables Activity History
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v EnableActivityFeed /t REG_DWORD /d 0 /f
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v PublishUserActivities /t REG_DWORD /d 0 /f
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v UploadUserActivities /t REG_DWORD /d 0 /f

            :: Disables Hibernation
            reg.exe add "HKLM\System\CurrentControlSet\Control\Session Manager\Power" /v HibernateEnabled /t REG_DWORD /d 0 /f
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FlyoutMenuSettings" /v ShowHibernateOption /t REG_DWORD /d 0 /f

            :: Disables Location Tracking
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location" /v Value /t REG_SZ /d Deny /f
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Sensor\Overrides\{BFA794E4-F964-4FDB-90F6-51056BFE4B44}" /v SensorPermissionState /t REG_DWORD /d 0 /f
            reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\lfsvc\Service\Configuration" /v Status /t REG_DWORD /d 0 /f
            reg.exe add "HKLM\SYSTEM\Maps" /v AutoUpdateEnabled /t REG_DWORD /d 0 /f

            :: Disables Telemetry
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection" /v AllowTelemetry /t REG_DWORD /d 0 /f
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v AllowTelemetry /t REG_DWORD /d 0 /f

            :: Disables Windows Ink Workspace
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace" /v AllowWindowsInkWorkspace /t REG_DWORD /d 0 /f

            :: Disables Feedback Notifications
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v DoNotShowFeedbackNotifications /t REG_DWORD /d 1 /f

            :: Disables the Advertising ID for All Users
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo" /v DisabledByGroupPolicy /t REG_DWORD /d 1 /f

            :: Disables Windows Error Reporting
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v Disabled /t REG_DWORD /d 1 /f

            :: Disables Delivery Optimization
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config" /v DODownloadMode /t REG_DWORD /d 0 /f

            :: Disables Remote Assistance
            reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Remote Assistance" /v fAllowToGetHelp /t REG_DWORD /d 0 /f

            :: Search Windows Update for Drivers First
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverSearching" /v SearchOrderConfig /t REG_DWORD /d 1 /f

            :: Gives Multimedia Applications like Games and Video Editing a Higher Priority
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" /v SystemResponsiveness /t REG_DWORD /d 0 /f
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" /v NetworkThrottlingIndex /t REG_DWORD /d 4294967295 /f

            :: Controls whether the memory page file is cleared at shutdown. Value 0 means it will not be cleared, speeding up shutdown.
            reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v ClearPageFileAtShutdown /t REG_DWORD /d 0 /f

            :: Enables NDU (Network Diagnostic Usage) Service on Startup
            reg.exe add "HKLM\SYSTEM\ControlSet001\Services\Ndu" /v Start /t REG_DWORD /d 2 /f

            :: Increases IRP stack size to 30 for the LanmanServer service to Improve Network Performance and Stability
            reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" /v IRPStackSize /t REG_DWORD /d 30 /f

            :: Hides the Meet Now Button on the Taskbar
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v HideSCAMeetNow /t REG_DWORD /d 1 /f

            :: Gives Graphics Cards a Higher Priority for Gaming
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v "GPU Priority" /t REG_DWORD /d 8 /f

            :: Gives the CPU a Higher Priority for Gaming
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v Priority /t REG_DWORD /d 6 /f

            :: Gives Games a higher priority in the system's scheduling
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v "Scheduling Category" /t REG_SZ /d "High" /f

            :: Fix Managed by your organization in Edge
            reg.exe delete "HKLM\SOFTWARE\Policies\Microsoft\Edge" /f

            :: Set Registry Keys to Disable Wifi-Sense
            reg.exe add "HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowWiFiHotSpotReporting" /v Value /t REG_DWORD /d 0 /f
            reg.exe add "HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowAutoConnectToWiFiSenseHotspots" /v Value /t REG_DWORD /d 0 /f

            :: Disables Storage Sense
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy" /v 01 /t REG_DWORD /d 0 /f

            :: Disable Xbox GameDVR
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\GameDVR" /v AllowGameDVR /t REG_DWORD /d 0 /f

            :: Disable Tablet Mode
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ImmersiveShell" /v TabletMode /t REG_DWORD /d 0 /f

            :: Always go to desktop mode on sign-in
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ImmersiveShell" /v SignInMode /t REG_DWORD /d 1 /f

            :: Disable "Use my sign-in info to automatically finish setting up my device after an update or restart"
            reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v DisableAutomaticRestartSignOn /t REG_DWORD /d 1 /f

            :: Disables OneDrive Automatic Backups of Important Folders (Documents, Pictures etc.)
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\OneDrive" /v KFMBlockOptIn /t REG_DWORD /d 1 /f
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\OneDrive" /v DisableFileSyncNGSC /t REG_DWORD /d 1 /f

            :: Disables the "Push To Install" feature in Windows
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\PushToInstall" /v "DisablePushToInstall" /t REG_DWORD /d 1 /f

            :: Disables Consumer Account State Content
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableConsumerAccountStateContent" /t REG_DWORD /d 1 /f

            :: Disables Cloud Optimized Content
            reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableCloudOptimizedContent" /t REG_DWORD /d 1 /f

            :: DELETES SCHEDULED TASKS REGISTRY KEYS
            :: Deleting Application Compatibility Appraiser
            reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0600DD45-FAF2-4131-A006-0B17509B9F78}" /f
            :: Deleting Customer Experience Improvement Program
            reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{4738DE7A-BCC1-4E2D-B1B0-CADB044BFA81}" /f
            reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{6FAC31FA-4A85-4E64-BFD5-2154FF4594B3}" /f
            reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{FC931F16-B50A-472E-B061-B6F79A71EF59}" /f
            :: Deleting Program Data Updater
            reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0671EB05-7D95-4153-A32B-1426B9FE61DB}" /f
            :: Deleting autochk proxy
            reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{87BF85F4-2CE1-4160-96EA-52F554AA28A2}" /f
            reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{8A9C643C-3D74-4099-B6BD-9C6D170898B1}" /f
            :: Deleting QueueReporting
            reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{E3176A65-4E44-4ED3-AA73-3283660ACB9C}" /f]]>
        </File>

        <!--Adds Items to Right-Click Context Menu-->
        <File path="C:\Windows\Setup\Scripts\contextmenu.reg"><![CDATA[
            Windows Registry Editor Version 5.00

            ; Adds "Take Ownership" to the Right Click Context Menu
            ; Created by: Shawn Brink
            ; Created on: September 6, 2021
            ; Updated on: January 7, 2024
            ; Tutorial: https://www.elevenforum.com/t/add-take-ownership-to-context-menu-in-windows-11.1230/

            [-HKEY_CLASSES_ROOT\*\shell\TakeOwnership]
            [-HKEY_CLASSES_ROOT\*\shell\runas]

            [HKEY_CLASSES_ROOT\*\shell\TakeOwnership]
            @="Take Ownership" "Extended"=-
            "HasLUAShield"="" "NoWorkingDirectory"="" "NeverDefault"=""

            [HKEY_CLASSES_ROOT\*\shell\TakeOwnership\command]
            @="powershell -windowstyle hidden -command \"Start-Process cmd -ArgumentList '/c takeown /f \\\"%1\\\" && icacls \\\"%1\\\" /grant *S-1-3-4:F /t /c /l & pause' -Verb runAs\"" "IsolatedCommand"= "powershell -windowstyle hidden -command \"Start-Process cmd -ArgumentList '/c takeown /f \\\"%1\\\" && icacls \\\"%1\\\" /grant *S-1-3-4:F /t /c /l & pause' -Verb runAs\""

            [HKEY_CLASSES_ROOT\Directory\shell\TakeOwnership]
            @="Take Ownership" "AppliesTo"="NOT (System.ItemPathDisplay:=\"C:\\Users\" OR System.ItemPathDisplay:=\"C:\\ProgramData\" OR System.ItemPathDisplay:=\"C:\\Windows\" OR System.ItemPathDisplay:=\"C:\\Windows\\System32\" OR System.ItemPathDisplay:=\"C:\\Program Files\" OR System.ItemPathDisplay:=\"C:\\Program Files (x86)\")" "Extended"=-
            "HasLUAShield"="" "NoWorkingDirectory"="" "Position"="middle"

            [HKEY_CLASSES_ROOT\Directory\shell\TakeOwnership\command]
            @="powershell -windowstyle hidden -command \"$Y = ($null | choice).Substring(1,1); Start-Process cmd -ArgumentList ('/c takeown /f \\\"%1\\\" /r /d ' + $Y + ' && icacls \\\"%1\\\" /grant *S-1-3-4:F /t /c /l /q & pause') -Verb runAs\"" "IsolatedCommand"="powershell -windowstyle hidden -command \"$Y = ($null | choice).Substring(1,1); Start-Process cmd -ArgumentList ('/c takeown /f \\\"%1\\\" /r /d ' + $Y + ' && icacls \\\"%1\\\" /grant *S-1-3-4:F /t /c /l /q & pause') -Verb runAs\""

            [HKEY_CLASSES_ROOT\Drive\shell\runas]
            @="Take Ownership" "Extended"=-
            "HasLUAShield"="" "NoWorkingDirectory"="" "Position"="middle" "AppliesTo"="NOT (System.ItemPathDisplay:=\"C:\\\")"

            [HKEY_CLASSES_ROOT\Drive\shell\runas\command]
            @="cmd.exe /c takeown /f \"%1\\\" /r /d y && icacls \"%1\\\" /grant *S-1-3-4:F /t /c & Pause" "IsolatedCommand"="cmd.exe /c takeown /f \"%1\\\" /r /d y && icacls \"%1\\\" /grant *S-1-3-4:F /t /c & Pause"]]>
        </File>

        <!--Default User Registry Entries - This Sets Features for the Default User-->
        <File path="C:\Windows\Setup\Scripts\defaultuser.cmd"><![CDATA[
            :: Disabling the Delivery of Personalized or Suggested Content Like App Suggestions, Tips, and Advertisements in Windows
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "ContentDeliveryAllowed" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "FeatureManagementEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "OEMPreInstalledAppsEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "PreInstalledAppsEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "PreInstalledAppsEverEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SilentInstalledAppsEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "RotatingLockScreenEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "RotatingLockScreenOverlayEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SoftLandingEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContentEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-310093Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338387Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338388Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338389Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338393Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353698Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353694Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353696Enabled" /t REG_DWORD /d 0 /f
            reg.exe delete "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager\Subscriptions" /f
            reg.exe delete "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager\SuggestedApps" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SystemPaneSuggestionsEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v TailoredExperiencesWithDiagnosticDataEnabled /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v IsMiEnabled /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Speech_OneCore\Settings\OnlineSpeechPrivacy" /v "HasAccepted" /t REG_DWORD /d 0 /f

            :: Removes Copilot
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Runonce" /v "UninstallCopilot" /t REG_SZ /d "" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot" /v TurnOffWindowsCopilot /t REG_DWORD /d 1 /f

            :: Removes Store Banner in Notepad
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Notepad" /v ShowStoreBanner /t REG_DWORD /d 0 /f

            :: Removes OneDrive
            reg.exe delete "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v OneDriveSetup /f

            :: Hides Search Icon on Taskbar
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" /v SearchboxTaskbarMode /t REG_DWORD /d 0 /f

            :: Start Menu Customizations
            :: Disables Recently Added Apps and Recommendations in the Start Menu
            ::reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\Explorer" /v HideRecentlyAddedApps /t REG_DWORD /d 1 /f
            reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v Start_IrisRecommendations /t REG_DWORD /d 0 /f

            :: Hides or Removes People from Taskbar
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\People" /v PeopleBand /t REG_DWORD /d 0 /f

            :: Hides Task View Button on Taskbar
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ShowTaskViewButton /t REG_DWORD /d 0 /f

            :: Hides and Removes News and Interests from PC and Taskbar
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Feeds" /v ShellFeedsTaskbarViewMode /t REG_DWORD /d 2 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Feeds" /v ShellFeedsEnabled /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds" /v EnableFeeds /t REG_DWORD /d 0 /f

            :: Disables User Account Sync
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v SettingSyncEnabled /t REG_DWORD /d 0 /f

            :: Disables Location Services
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v LocationServicesEnabled /t REG_DWORD /d 0 /f

            :: Disables Input Personalization Settings
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Personalization\Settings" /v AcceptedPrivacyPolicy /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\InputPersonalization" /v RestrictImplicitTextCollection /t REG_DWORD /d 1 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\InputPersonalization" /v RestrictImplicitInkCollection /t REG_DWORD /d 1 /f

            :: Disables Automatic Feedback Sampling
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Feedback" /v AutoSample /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Feedback" /v ServiceEnabled /t REG_DWORD /d 0 /f

            :: Disables Recent Documents Tracking
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v Start_TrackDocs /t REG_DWORD /d 0 /f

            :: Disables Background Apps
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" /v GlobalUserDisabled /t REG_DWORD /d 1 /f

            :: Disable "Let websites provide locally relevant content by accessing my language list"
            reg.exe add "HKU\DefaultUser\Control Panel\International\User Profile" /v HttpAcceptLanguageOptOut /t REG_DWORD /d 1 /f

            :: Disables "Let Windows track app launches to improve Start and search results"
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v Start_TrackProgs /t REG_DWORD /d 0 /f

            :: Disables App Diagnostics
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\AppDiagnostics" /v AppDiagnosticsEnabled /t REG_DWORD /d 0 /f

            :: Disables Delivery Optimization
            ::reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization" /v DODownloadMode /t REG_DWORD /d 0 /f

            :: Disables Tablet Mode
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ImmersiveShell" /v TabletMode /t REG_DWORD /d 0 /f

            :: Disables Use Sign-In Info for User Account
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication" /v UseSignInInfo /t REG_DWORD /d 0 /f

            :: Disables Maps Auto Download
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Maps" /v AutoDownload /t REG_DWORD /d 0 /f

            :: Disables Telemetry and Ads
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Siuf\Rules" /v NumberOfSIUFInPeriod /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableTailoredExperiencesWithDiagnosticData /t REG_DWORD /d 1 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsConsumerFeatures /t REG_DWORD /d 1 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ShowSyncProviderNotifications /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v Enabled /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\InputPersonalization\TrainedDataStore" /v "HarvestContacts" /t REG_DWORD /d 0 /f

            :: Manages and displays the status of ongoing operations, such as file copy, move, delete, etc.
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\OperationStatusManager" /v EnthusiastMode /t REG_DWORD /d 1 /f

            :: Set File Explorer to Open This PC instead of Quick Access
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v LaunchTo /t REG_DWORD /d 1 /f

            :: Set Display for Performance
            reg.exe add "HKU\DefaultUser\Control Panel\Desktop" /v MenuShowDelay /t REG_DWORD /d 1 /f

            :: On Shutdown, Windows will automatically close any running applications
            reg.exe add "HKU\DefaultUser\Control Panel\Desktop" /v AutoEndTasks /t REG_DWORD /d 1 /f

            :: Sets the Mouse hover time to 400 milliseconds
            reg.exe add "HKU\DefaultUser\Control Panel\Mouse" /v MouseHoverTime /t REG_SZ /d "400" /f

            :: Hides the Meet Now Button on the Taskbar
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v HideSCAMeetNow /t REG_DWORD /d 1 /f

            :: Disables the Second Out-Of-Box Experience
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\UserProfileEngagement" /v ScoobeSystemSettingEnabled /t REG_DWORD /d 0 /f

            :: Set Display for Performance
            reg.exe add "HKU\DefaultUser\Control Panel\Desktop" /v DragFullWindows /t REG_SZ /d 1 /f
            reg.exe add "HKU\DefaultUser\Control Panel\Desktop" /v MenuShowDelay /t REG_SZ /d 200 /f
            reg.exe add "HKU\DefaultUser\Control Panel\Desktop\WindowMetrics" /v MinAnimate /t REG_SZ /d 0 /f
            reg.exe add "HKU\DefaultUser\Control Panel\Keyboard" /v KeyboardDelay /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ListviewAlphaSelect /t REG_DWORD /d 1 /f
            reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ListviewShadow /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarAnimations /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarMn /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarDa /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" /v VisualFXSetting /t REG_DWORD /d 3 /f
            reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\DWM" /v EnableAeroPeek /t REG_DWORD /d 0 /f

            :: Set Registry Keys to Enable End Task With Right Click
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarDeveloperSettings /t REG_DWORD /d 1 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarEndTask /t REG_DWORD /d 1 /f

            :: Disable Xbox GameDVR
            reg.exe add "HKU\DefaultUser\System\GameConfigStore" /v GameDVR_FSEBehavior /t REG_DWORD /d 2 /f
            reg.exe add "HKU\DefaultUser\System\GameConfigStore" /v GameDVR_Enabled /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\System\GameConfigStore" /v GameDVR_DXGIHonorFSEWindowsCompatible /t REG_DWORD /d 1 /f
            reg.exe add "HKU\DefaultUser\System\GameConfigStore" /v GameDVR_HonorUserFSEBehaviorMode /t REG_DWORD /d 1 /f
            reg.exe add "HKU\DefaultUser\System\GameConfigStore" /v GameDVR_EFSEFeatureFlags /t REG_DWORD /d 0 /f

            :: Disables Bing Search in Start Menu
            reg.exe add "HKU\DefaultUser\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v DisableSearchBoxSuggestions /t REG_DWORD /d 1 /f

            :: Disables Mouse Acceleration
            reg.exe add "HKU\DefaultUser\Control Panel\Mouse" /v MouseSpeed /t REG_SZ /d "0" /f
            reg.exe add "HKU\DefaultUser\Control Panel\Mouse" /v MouseThreshold1 /t REG_SZ /d "0" /f
            reg.exe add "HKU\DefaultUser\Control Panel\Mouse" /v MouseThreshold2 /t REG_SZ /d "0" /f

            :: Disables Sticky Keys
            reg.exe add "HKU\DefaultUser\Control Panel\Accessibility\StickyKeys" /v Flags /t REG_SZ /d "506" /f
            reg.exe add "HKU\DefaultUser\Control Panel\Accessibility\StickyKeys" /v HotkeyFlags /t REG_SZ /d "58" /f

            :: Disables Snap Assist Flyout
            reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v SnapAssist /t REG_DWORD /d 0 /f

            :: Enables Show File Extensions
            reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v HideFileExt /t REG_DWORD /d 0 /f

            :: Enables Dark Mode
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v AppsUseLightTheme /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v ColorPrevalence /t REG_DWORD /d 0 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v EnableTransparency /t REG_DWORD /d 1 /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v SystemUsesLightTheme /t REG_DWORD /d 0 /f

            :: Restore Windows Photo Viewer and Set as Default Program for Image Files
            :: Restore Windows Photo Viewer
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.bmp" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.cr2" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.dib" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.gif" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.ico" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.jfif" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.jpe" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.jpeg" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.jpg" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.jxr" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.png" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.tif" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.tiff" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.wdp" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            :: Create Relevant File Associations
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.bmp\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.cr2\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.dib\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.gif\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ico\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jfif\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jpe\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jpeg\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jpg\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jxr\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.png\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.tif\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.tiff\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.wdp\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f

            :: Disables Windows Recall on Copilot+ PC - Credit Britec09
            reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\WindowsAI" /f
            reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\WindowsAI" /v "DisableAIDataAnalysis" /t REG_DWORD /d 1 /f
            reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\Windows AI" /v "TurnOffSavingSnapshots" /t REG_DWORD /d 1 /f]]>
        </File>

        <!--Current User Registry Entries - This Sets Features for the Current User as Some Entries Defined in DefaultUser is Reset for Some Reason-->
        <File path="C:\Windows\Setup\Scripts\currentuser.cmd"><![CDATA[
            :: Disabling the Delivery of Personalized or Suggested Content Like App Suggestions, Tips, and Advertisements in Windows
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "ContentDeliveryAllowed" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "FeatureManagementEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "OEMPreInstalledAppsEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "PreInstalledAppsEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "PreInstalledAppsEverEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SilentInstalledAppsEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "RotatingLockScreenEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "RotatingLockScreenOverlayEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SoftLandingEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContentEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-310093Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338387Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338388Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338389Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338393Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353698Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353694Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353696Enabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SystemPaneSuggestionsEnabled" /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v TailoredExperiencesWithDiagnosticDataEnabled /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v IsMiEnabled /t REG_DWORD /d 0 /f
            reg.exe delete "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager\Subscriptions" /f
            reg.exe delete "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager\SuggestedApps" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Speech_OneCore\Settings\OnlineSpeechPrivacy" /v "HasAccepted" /t REG_DWORD /d 0 /f


            :: Removes Copilot
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Runonce" /v "UninstallCopilot" /t REG_SZ /d "" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\Windows\WindowsCopilot" /v TurnOffWindowsCopilot /t REG_DWORD /d 1 /f

            :: Removes Store Banner in Notepad
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Notepad" /v ShowStoreBanner /t REG_DWORD /d 0 /f

            :: Removes OneDrive
            reg.exe delete "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v OneDriveSetup /f

            :: Hides Search Icon on Taskbar
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" /v SearchboxTaskbarMode /t REG_DWORD /d 0 /f

            :: Start Menu Customizations
            :: Disables Recently Added Apps and Recommendations in the Start Menu
            reg.exe add "HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Explorer" /v HideRecentlyAddedApps /t REG_DWORD /d 1 /f
            reg.exe add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v Start_IrisRecommendations /t REG_DWORD /d 0 /f

            :: Hides or Removes People from Taskbar
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\People" /v PeopleBand /t REG_DWORD /d 0 /f

            :: Hides Task View Button on Taskbar
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ShowTaskViewButton /t REG_DWORD /d 0 /f

            :: Hides and Removes News and Interests from PC and Taskbar
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Feeds" /v ShellFeedsTaskbarViewMode /t REG_DWORD /d 2 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Feeds" /v ShellFeedsEnabled /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds" /v EnableFeeds /t REG_DWORD /d 0 /f

            :: Disables User Account Sync
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v SettingSyncEnabled /t REG_DWORD /d 0 /f

            :: Disables Location Services
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v LocationServicesEnabled /t REG_DWORD /d 0 /f

            :: Disables Input Personalization Settings
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Personalization\Settings" /v AcceptedPrivacyPolicy /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\InputPersonalization" /v RestrictImplicitTextCollection /t REG_DWORD /d 1 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\InputPersonalization" /v RestrictImplicitInkCollection /t REG_DWORD /d 1 /f

            :: Disables Automatic Feedback Sampling
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Feedback" /v AutoSample /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Feedback" /v ServiceEnabled /t REG_DWORD /d 0 /f

            :: Disables Recent Documents Tracking
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v Start_TrackDocs /t REG_DWORD /d 0 /f

            :: Disable "Let websites provide locally relevant content by accessing my language list"
            reg.exe add "HKEY_CURRENT_USER\Control Panel\International\User Profile" /v HttpAcceptLanguageOptOut /t REG_DWORD /d 1 /f

            :: Disables "Let Windows track app launches to improve Start and search results"
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v Start_TrackProgs /t REG_DWORD /d 0 /f

            :: Disables Background Apps
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" /v GlobalUserDisabled /t REG_DWORD /d 1 /f

            :: Disables App Diagnostics
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\AppDiagnostics" /v AppDiagnosticsEnabled /t REG_DWORD /d 0 /f

            :: Disables Delivery Optimization
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization" /v DODownloadMode /t REG_DWORD /d 0 /f

            :: Disables Tablet Mode
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\ImmersiveShell" /v TabletMode /t REG_DWORD /d 0 /f

            :: Disables Use Sign-In Info for User Account
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication" /v UseSignInInfo /t REG_DWORD /d 0 /f

            :: Disables Maps Auto Download
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Maps" /v AutoDownload /t REG_DWORD /d 0 /f

            :: Disables Telemetry and Ads
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Siuf\Rules" /v NumberOfSIUFInPeriod /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableTailoredExperiencesWithDiagnosticData /t REG_DWORD /d 1 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsConsumerFeatures /t REG_DWORD /d 1 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ShowSyncProviderNotifications /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v Enabled /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\InputPersonalization\TrainedDataStore" /v "HarvestContacts" /t REG_DWORD /d 0 /f

            :: Manages and displays the status of ongoing operations, such as file copy, move, delete, etc.
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\OperationStatusManager" /v EnthusiastMode /t REG_DWORD /d 1 /f

            :: Set File Explorer to Open This PC instead of Quick Access
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v LaunchTo /t REG_DWORD /d 1 /f

            :: Set Display for Performance
            reg.exe add "HKEY_CURRENT_USER\Control Panel\Desktop" /v MenuShowDelay /t REG_DWORD /d 1 /f

            :: On Shutdown, Windows will automatically close any running applications
            reg.exe add "HKEY_CURRENT_USER\Control Panel\Desktop" /v AutoEndTasks /t REG_DWORD /d 1 /f

            :: Sets the Mouse hover time to 400 milliseconds
            reg.exe add "HKEY_CURRENT_USER\Control Panel\Mouse" /v MouseHoverTime /t REG_SZ /d "400" /f

            :: Hides the Meet Now Button on the Taskbar
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v HideSCAMeetNow /t REG_DWORD /d 1 /f

            :: Disables the Second Out-Of-Box Experience
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\UserProfileEngagement" /v ScoobeSystemSettingEnabled /t REG_DWORD /d 0 /f

            :: Set Display for Performance
            reg.exe add "HKEY_CURRENT_USER\Control Panel\Desktop" /v DragFullWindows /t REG_SZ /d 1 /f
            reg.exe add "HKEY_CURRENT_USER\Control Panel\Desktop" /v MenuShowDelay /t REG_SZ /d 200 /f
            reg.exe add "HKEY_CURRENT_USER\Control Panel\Desktop\WindowMetrics" /v MinAnimate /t REG_SZ /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\Control Panel\Keyboard" /v KeyboardDelay /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ListviewAlphaSelect /t REG_DWORD /d 1 /f
            reg.exe add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ListviewShadow /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarAnimations /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarMn /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarDa /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" /v VisualFXSetting /t REG_DWORD /d 3 /f
            reg.exe add "HKEY_CURRENT_USER\Software\Microsoft\Windows\DWM" /v EnableAeroPeek /t REG_DWORD /d 0 /f

            :: Set Registry Keys to Enable End Task With Right Click
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarDeveloperSettings /t REG_DWORD /d 1 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarEndTask /t REG_DWORD /d 1 /f

            :: Disable Xbox GameDVR
            reg.exe add "HKEY_CURRENT_USER\System\GameConfigStore" /v GameDVR_FSEBehavior /t REG_DWORD /d 2 /f
            reg.exe add "HKEY_CURRENT_USER\System\GameConfigStore" /v GameDVR_Enabled /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\System\GameConfigStore" /v GameDVR_DXGIHonorFSEWindowsCompatible /t REG_DWORD /d 1 /f
            reg.exe add "HKEY_CURRENT_USER\System\GameConfigStore" /v GameDVR_HonorUserFSEBehaviorMode /t REG_DWORD /d 1 /f
            reg.exe add "HKEY_CURRENT_USER\System\GameConfigStore" /v GameDVR_EFSEFeatureFlags /t REG_DWORD /d 0 /f

            :: Disables Bing Search in Start Menu
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v DisableSearchBoxSuggestions /t REG_DWORD /d 1 /f

            :: Disables Mouse Acceleration
            reg.exe add "HKEY_CURRENT_USER\Control Panel\Mouse" /v MouseSpeed /t REG_SZ /d "0" /f
            reg.exe add "HKEY_CURRENT_USER\Control Panel\Mouse" /v MouseThreshold1 /t REG_SZ /d "0" /f
            reg.exe add "HKEY_CURRENT_USER\Control Panel\Mouse" /v MouseThreshold2 /t REG_SZ /d "0" /f

            :: Disables Sticky Keys
            reg.exe add "HKEY_CURRENT_USER\Control Panel\Accessibility\StickyKeys" /v Flags /t REG_SZ /d "506" /f
            reg.exe add "HKEY_CURRENT_USER\Control Panel\Accessibility\StickyKeys" /v HotkeyFlags /t REG_SZ /d "58" /f

            :: Disables Snap Assist Flyout
            reg.exe add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v SnapAssist /t REG_DWORD /d 0 /f

            :: Enables Show File Extensions
            reg.exe add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v HideFileExt /t REG_DWORD /d 0 /f

            :: Enables Dark Mode
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v AppsUseLightTheme /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v ColorPrevalence /t REG_DWORD /d 0 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v EnableTransparency /t REG_DWORD /d 1 /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v SystemUsesLightTheme /t REG_DWORD /d 0 /f

            :: Restore Windows Photo Viewer and Set as Default Program for Image Files
            :: Restore Windows Photo Viewer
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.bmp" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.cr2" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.dib" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.gif" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.ico" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.jfif" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.jpe" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.jpeg" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.jpg" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.jxr" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.png" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.tif" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.tiff" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Classes\.wdp" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
            :: Create Relevant File Associations
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.bmp\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.cr2\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.dib\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.gif\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ico\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jfif\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jpe\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jpeg\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jpg\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jxr\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.png\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.tif\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.tiff\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
            reg.exe add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.wdp\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f

            :: Disables Windows Recall on Copilot+ PC - Credit Britec09
            reg.exe add "HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\WindowsAI" /f
            reg.exe add "HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\WindowsAI" /v "DisableAIDataAnalysis" /t REG_DWORD /d 1 /f
            reg.exe add "HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Windows AI" /v "TurnOffSavingSnapshots" /t REG_DWORD /d 1 /f

            net user %USERNAME% /logonpasswordchg:yes]]>
        </File>

        <File path="C:\Windows\Setup\Scripts\currentuser.ps1"><![CDATA[
            $logFile = "%TEMP%\currentuser.log"
            Start-Transcript -Path $logFile

            Start-Sleep 30

            # Eject all CDs
            $driveEject = New-Object -comObject Shell.Application
            Get-CimInstance Win32_LogicalDisk | ?{ $_.DriveType -eq 5} | ForEach-Object {
                $driveEject.Namespace(17).ParseName($_.DeviceID).InvokeVerb("Eject")
            }

            Stop-Transcript
            shutdown /r /t 10]]>
        </File>

        <!--Start Menu Template (Credit:https://schneegans.de/windows/unattend-generator/)-->
        <File path="C:\Users\Default\AppData\Local\Microsoft\Windows\Shell\LayoutModification.xml"><![CDATA[
<LayoutModificationTemplate Version="1" xmlns="http://schemas.microsoft.com/Start/2014/LayoutModification">
	<LayoutOptions StartTileGroupCellWidth="6" />
	<DefaultLayoutOverride>
		<StartLayoutCollection>
			<StartLayout GroupCellWidth="6" xmlns="http://schemas.microsoft.com/Start/2014/FullDefaultLayout" />
		</StartLayoutCollection>
	</DefaultLayoutOverride>
</LayoutModificationTemplate>]]>
        </File>
        <File path="C:\Users\Default\AppData\Local\Microsoft\Windows\Shell\LayoutModification.json"><![CDATA[
{
    "primaryOEMPins": [
        {
            "desktopAppLink": "%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Microsoft Edge.lnk"
        },
        {
            "packagedAppId": "windows.immersivecontrolpanel_cw5n1h2txyewy!microsoft.windows.immersivecontrolpanel"
        },
        {
            "desktopAppLink": "%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\File Explorer.lnk"
        },
        {
            "desktopAppLink": "%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\System Tools\\Control Panel.lnk"
        },
        {
            "desktopAppLink": "%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\System Tools\\Command Prompt.lnk"
        },
        {
            "desktopAppLink": "%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\Windows PowerShell.lnk"
        }
    ]
}]]>
        </File>
        <File path="C:\Windows\Setup\Scripts\Warez.ps1"><![CDATA[
            $logFile = "C:\Windows\Setup\Scripts\Warez.log"
            Start-Transcript -Path $logFile -IncludeInvocationHeader

            foreach( $letter in 'DEFGHIJKLMNOPQRSTUVWXYZ'.ToCharArray() ) {
                $warezDir = "${letter}:\Warez\"
                if( Test-Path -LiteralPath $warezDir ) {
                    Get-ChildItem -Path $warezDir -Attributes Directory |
                    Foreach-Object {
                        Write-Host "Installing $($_.Basename) ..."
                        & ($_.FullName + '\install.ps1')
                    }
                    break
                }
            }
            Stop-Transcript]]>
        </File>
        <File path="C:\Windows\Setup\Scripts\cloudinit.ps1"><![CDATA[
            $logFile = "C:\Windows\Setup\Scripts\cloudinit.log"
            Start-Transcript -IncludeInvocationHeader -Path $logFile

            foreach( $letter in 'DEFGHIJKLMNOPQRSTUVWXYZ'.ToCharArray() ) {
                $infoDir = "${letter}:\OPENSTACK\CONTENT"
                $netInfo = @{}
                $nicName = "Ethernet"
                if( Test-Path -LiteralPath $infoDir ) {
                    foreach ($line in Get-Content ($infoDir + "\0000")) {
                        if ($line -match '^\s*([a-z_ ]*) ([0-9.]*)$') {
                            $netInfo.add($Matches.1, $Matches.2)
                        }
                    }

                    netsh interface ipv4 set address name=$nicName static $netInfo["address"] $netInfo["netmask"] $netInfo["gateway"]
                    netsh interface ipv4 set dns name=$nicName static $netInfo["dns_nameservers"]
                    break
                }
            }

            Stop-Transcript]]>
        </File>
        <File path="C:\Windows\Setup\Scripts\openssh.ps1"><![CDATA[
            $logFile = "C:\Windows\Setup\Scripts\openssh.log"
            Start-Transcript -Path $logFile -IncludeInvocationHeader

            Set-Location -ErrorAction Stop -LiteralPath $PSScriptRoot

            Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0
            Set-Service -Name sshd -StartupType 'Automatic'

            # Set PowerShell as OpenSSH default shell
            New-ItemProperty -Path "HKLM:\SOFTWARE\OpenSSH" `
                            -Name DefaultShell `
                            -Value "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" `
                            -PropertyType String `
                            -Force

            Stop-Transcript]]>
        </File>
    </Extensions>
</unattend>